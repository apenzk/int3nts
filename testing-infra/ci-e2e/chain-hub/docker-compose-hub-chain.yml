# APTOS_DOCKER_IMAGE is defined in util.sh and exported before docker-compose runs
services:
  # Aptos Localnet Hub - following the single-validator approach
  aptos-localnet-chain1:
    image: ${APTOS_DOCKER_IMAGE}
    container_name: aptos-localnet-chain1
    network_mode: host
    volumes:
      - aptos-data:/aptos/config
      - /var/run/docker.sock:/var/run/docker.sock
    command: >
      sh -c "
        echo 'Starting Aptos Localnet Hub with faucet (fresh start)...' &&
        aptos node run-localnet --with-faucet --force-restart --assume-yes
      "
    restart: unless-stopped

volumes:
  aptos-data:

